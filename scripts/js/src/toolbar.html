<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="jquery-ui-1.8.16.custom.css" type="text/css" media="all">
	<link rel="stylesheet" href="toolbar.css" type="text/css" media="all">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
	<script src="http://jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script>
	<script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script>

	<script type="text/javascript" src="argouml/rev_4600_inheritance.js"></script>
	<script type="text/javascript" src="argouml/rev_4600_invocations.js"></script>
	<script type="text/javascript" src="ModelGraph.js"></script>
	<script type="text/javascript" src="Trees.js"></script>
	<script type="text/javascript" src="Sunbursts.js"></script>
	<script type="text/javascript" src="Graph.js"></script>
	<script type="text/javascript" src="GraphToD3Graph.js"></script>


	<script type="text/javascript" src="edge_data.js"></script>
	<script type="text/javascript" src="node_data.js"></script>
	<script type="text/javascript" src="displayInfo.js"></script>
	<script type="text/javascript" src="force.js"></script>
	<script type="text/javascript" src="VisualizationRegister.js"></script>
	<script type="text/javascript" src="Visualization.js"></script>
	<script type="text/javascript" src="options/SizeFunction.js"></script>
    <script type="text/javascript" src="options/ColorFunction.js"></script>
	<script type="text/javascript" src="Analysis.js"> </script>

</head>
<meta charset="utf-8">
	<script type="text/javascript">
	
	$(function() {
		$( "#toolbar" ).accordion();
	});
	
	$(function() {
		$( "#toolbar" ).draggable();
	});

	var size = 0;
	var analysis = new Array();
	var register = new VisualizationsRegister();
	var currentAnalysis;
	
	// Initializing analysis
	analysis.push(inheritanceHierarchyAnalysis);
	analysis.push(callGraph);
	analysis.push(revisionRelatedChanges);
	analysis.push(bugAuthorRelation);
	analysis.push(entityAuthorRelation);
	analysis.push(genericGraph);
	
	// Initializing Visualizations Register
	register.addVisualization(TreeVisualization);
	register.addVisualization(GraphVisualization);
	register.addVisualization(SunburstVisualization);

	function showVizFor(analysis) {
		var visualizations = getVizFor(analysis);
		if($(visualizations).length > 0) {
			var newAccordion = '<h3><a href="#">Visualizations</a></h3><div><ul>';
			$.each(visualizations,
				function(index, viz) { 
					newAccordion += '<li><a href="#" onClick="javascript:showOptsFor(\'' + viz + '\');">' + viz.name() + '</a></li>';
				});	
			updateAccordion(newAccordion + '</ul></li>');
		} else {
			alert('No visualizations for this analysis');
		}
	}
	
	function showOptsFor(viz) {
		var options = getOptsFor(viz);
		if($(options).length > 0) {
			var newAccordion = '<h3><a href="#">Options</a></h3><div><ul>';
			$.each(options,
				function(index, option) { 
					newAccordion += '<li>' + option + '</li>';
				});	
			updateAccordion(newAccordion + '</ul></li>');
		} else {
			alert('No options to visualize!');
		}
	}
	
	function updateAccordion(additionalToolbar) {
		$('#toolbar').append(additionalToolbar).accordion('destroy').accordion();
		$("#toolbar").accordion( "activate" , ++size)
	}
	
	function getVizFor(analysis) {
		currentAnalysis = analysis;
		return register.getVisualizations([analysis]);
	}
	
	function getOptsFor(viz) {
		// if(currentAnalysis) {
			var opts = getOptions(currentAnalysis, viz);
			// alert(opts);
		// } else {
			// return []
		// }
	}	
	</script>


</head>
	<div id="toolbar">
		<h3><a href="#">Analysis</a></h3>
		<div>
			<ul id="analysis-list">
				<script type="text/javascript">
					var list = '<ul>';
					$.each(analysis, function(index, anAalysis) {
						list += '<li><a href="#" onclick="showVizFor(\''+ anAalysis +'\')">' + anAalysis.name + '</li>'
					});
					list += '</ul>';
					document.getElementById('analysis-list').innerHTML += list;
				</script>
				<!-- <li><a href="#" onClick="javascript:showVizFor('Inheritance Hierarchy');")>Inheritance Hierarchy</a></li>
				<li><a href="#" onClick="javascript:showVizFor('Call Graph');")>Call Graph</a></li>
				<li><a href="#" onClick="javascript:showVizFor('Revision Related Changes');")>Revision Related Changes</a></li>
				<li><a href="#" onClick="javascript:showVizFor('Bug-Author Relationship');")>Bug-Author Relationship</a></li>
				<li><a href="#" onClick="javascript:showVizFor('Entity-Author Relationship);")>Entity-Author Relationship</a></li>
				<li><a href="#" onClick="javascript:showVizFor('Generic Graph');")>Generic Graph</a></li>	 -->
				<!-- <li><a href="#" id="delete">Delete</a></li>				 -->
			</ul>
		</div>
	</div>
	
	<script type="text/javascript" charset="utf-8">
		$(document).ready(function() {
			$('#delete').click(function() {
				var parent = $(this).closest('div').nextUntil('div');
			    var head = parent.prev('h3');
			    parent.add(head).fadeOut('slow',function(){$(this).remove();});
			});
		});
	</script>
	
</html>